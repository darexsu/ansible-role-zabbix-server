---
- name: Converge
  hosts: all 
  become: true

  pre_tasks:
  - name: Unnessessary command
    ansible.builtin.shell:
      cmd: "{{ lookup('env', 'ANSIBLE_COMMAND') }}"
    when: lookup('env', 'ANSIBLE_COMMAND') | length > 0
  
  vars:
    merge:
# Zabbix-server -------
      zabbix_server:
        enabled: true
        version: "6.0"
        server_name: "Zabbix server"
        db_type: "MYSQL"
        db_port: "3306"
        db_name: "zabbix"
        db_user: "zabbix"
        db_password: "change_me"
      zabbix_server_install:
        enabled: true
      zabbix_server_repo:
        enabled: true
      zabbix_server_conf:
        enabled: true
# MariaDB -------------     
      mariadb:
        enabled: true
        version: "10.5"
      mariadb_repo:
        enabled: true
      mariadb_install:
        enabled: true
        remove_old:
          enabled: true
      mariadb_database:
        zabbix_server:
          enabled: true
          remove_old: true
      mariadb_user:
        zabbix_server:
          enabled: true
      mariadb_sql:
        zabbix_server:
          schema: true

  tasks:
  - name: include role darexsu.zabbix_server
    include_role: 
      name: darexsu.zabbix_server